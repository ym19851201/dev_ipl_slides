<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <title>OpenCV</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"/>

  <link rel="stylesheet" href=".//css/reset.css" type="text/css"/>

  

  <link type="text/css" href=".//css/fg.menu.css" media="screen" rel="stylesheet" />
  <link type="text/css" href=".//css/theme/ui.all.css" media="screen" rel="stylesheet" />
  <link type="text/css" href=".//css/sh_style.css" rel="stylesheet" />
  <link type="text/css" href=".//css/tipsy.css" rel="stylesheet" />

  <link rel="stylesheet" href=".//css/showoff.css" type="text/css"/>

  <script type="text/javascript" src=".//js/jquery-1.4.2.min.js"></script>
  <script type="text/javascript" src=".//js/jquery.cycle.all.js"></script>
	<script type="text/javascript" src=".//js/jquery-print.js"></script>
  <script type="text/javascript" src=".//js/jquery.batchImageLoad.js"></script>
  <script type="text/javascript" src=".//js/jquery.parsequery.min.js"></script>
  <script type="text/javascript" src=".//js/jquery.doubletap-0.1.js"></script>
  <script type="text/javascript" src=".//js/jquery.tipsy.js"></script>

  <script type="text/javascript" src=".//js/fg.menu.js"></script>
  <script type="text/javascript" src=".//js/showoff.js"></script>
  <script type="text/javascript" src=".//js/jTypeWriter.js"> </script>
  <script type="text/javascript" src=".//js/sh_main.min.js"></script>
  <script type="text/javascript" src=".//js/core.js"></script>
  <script type="text/javascript" src=".//js/showoffcore.js"></script>
  <script type="text/javascript" src=".//js/coffee-script.js"></script>

  
    
      <script type="text/javascript" src=".//js/sh_lang/sh_ruby.min.js"></script>
    
  

  
    
    <link rel="stylesheet" href=".//file/custom.css" type="text/css"/>
  

  

  <script type="text/javascript">
    $(function(){
      setupPreso(false, './');
    });

    editUrl  = "";
  </script>

</head>

<body>

<a tabindex="0" href="#search-engines" class="fg-button fg-button-icon-right ui-widget ui-state-default ui-corner-all" id="navmenu"><span class="ui-icon ui-icon-triangle-1-s"></span>slides</a>
<div id="navigation" class="hidden"></div>
<a tabindex="1" href="#search-engines" class="fg-button fg-button-icon-right ui-widget ui-state-default ui-corner-all" id="stylemenu"><span class="ui-icon ui-icon-triangle-1-s"></span>styles</a>
<div id="stylepicker" class="hidden"></div>


<div id="help">
  <table>
    <tr><td class="key">z, ?</td><td>toggle help (this)</td></tr>
    <tr><td class="key">space, &rarr;</td><td>next slide</td></tr>
    <tr><td class="key">shift-space, &larr;</td><td>previous slide</td></tr>
    <tr><td class="key">b</td><td>blank screen</td></tr>
    <tr><td class="key">d</td><td>toggle debug mode</td></tr>
    <tr><td class="key">## &lt;ret&gt;</td><td>go to slide #</td></tr>
    <tr><td class="key">c, t</td><td>table of contents (vi)</td></tr>
    <tr><td class="key">f</td><td>toggle footer</td></tr>
    <tr><td class="key">g</td><td>toggle follow</td></tr>
    <tr><td class="key">r</td><td>reload slides</td></tr>
    <tr><td class="key">n</td><td>toggle notes</td></tr>
    <tr><td class="key">p</td><td>run preshow</td></tr>
    <tr><td class="key">P</td><td>toggle pause</td></tr>
    <tr><td class="key">s</td><td>choose style</td></tr>
  </table>
</div>

<div class="buttonNav">
  <input type="submit" onClick="prevStep();" value="prev"/>
  <input type="submit" onClick="nextStep();" value="next"/>
</div>

<div id="preso"><center>loading presentation...</center></div>
<div id="footer">
  <span id="followMode"></span>
  <span id="slideInfo"></span>
  <span id="debugInfo"></span>
  <span id="notesInfo"></span>
  <span id="slideFilename"></span>
  <img id="disconnected" src=".//css/disconnected.png" />
</div>

<div id="slides" class="offscreen" style="display:none;">
<div id="one_01_slide" class="slide subsection" data-transition="none">
<div class="content subsection" ref="one/01_slide/1">
<h1>OpenCVいじってみた</h1>
</div>
</div>
<div id="one_01_slide" class="slide bullets incremental" data-transition="none">
<div class="content bullets incremental" ref="one/01_slide/2">
<h1>もくじ</h1>

<ul>
<li>OpenCVって何さ？</li>
<li>オブジェクト検出

<ul>
<li>機械学習</li>
<li>オブジェクト検出器</li>
</ul>
</li>
<li>何に使おうか？

<ul>
<li>笑い男ごっこ（俺の目を盗んだな）</li>
<li>I am ぼるだりんがー</li>
<li>うちの子(ランバ・ラル)検出</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="one_01_slide" class="slide smaller" data-transition="none">
<div class="content smaller" ref="one/01_slide/3">
<h1>OpenCVって何さ？</h1>

<ul>
<li>線形代数や統計処理など，コンピュータビジョンに必要な各種数学関数</li>
<li>直線や曲線，テキストなど画像への描画関数</li>
<li>OpenCVで使用したデータを読み込み/保存するための関数</li>
<li>エッジ等の特徴抽出や画像の幾何変換，カラー処理等々の画像処理関数</li>
<li>物体追跡や動き推定などの動画像処理用関数</li>
<li>物体検出などのパターン認識関数</li>
<li>三次元復元のためのカメラ位置や姿勢の検出などのカメラキャリブレーション関数</li>
<li>コンピュータにパターンを学習させるための機械学習関数</li>
<li>画像の読み込みや保存，表示，ビデオ入出力などインターフェース用関数</li>
</ul>
</div>
</div>
<div id="one_01_slide" class="slide " data-transition="none">
<div class="content " ref="one/01_slide/4">
<h2>OpenCVって何さ？</h2>

<h1>・・・</h1>
</div>
</div>
<div id="one_01_slide" class="slide small" data-transition="none">
<div class="content small" ref="one/01_slide/5">
<div class="aa">

　　　　　　　　　　　　 ／）<br>
　　　　　　　　　　　／／／）<br>
　　　　　　　　　 ／,.=ﾞ''"／<br>
　　　／　　　　 i f　,.r='"-‐'つ＿＿＿_　　　こまけぇこたぁいいんだよ！！<br>
　　/　　　　　 /　　　_,.-‐'~／⌒　　⌒＼<br>
　　　　／　　 ,i　　　,二ﾆ⊃（ ●）.　（●）＼<br>
　　　/　　　 ﾉ　　　 ilﾞフ::::::⌒（__人__）⌒::::: ＼<br>
　　　　　　,ｲ｢ﾄ､　　,!,!|　　　　　|r┬-|　　　　　|<br>
　　　　　/　iﾄヾヽ_/ｨ"＼　　　　 `ー'´　　　 ／<br>

</div>

<h2>結局何がしたいって画像認識だしね</h2>
</div>
</div>
<div id="one_02_slide" class="slide subsection" data-transition="none">
<div class="content subsection" ref="one/02_slide/1">
<h1>オブジェクト検出</h1>
</div>
</div>
<div id="one_02_slide" class="slide small" data-transition="none">
<div class="content small" ref="one/02_slide/2">
<h1>オブジェクト検出の流れ</h1>

<ul>
<li>サンプル作成

<ul>
<li>画像を集める</li>
</ul>
</li>
<li>機械学習によって検出器作成

<ul>
<li>マシンに頑張ってもらう</li>
</ul>
</li>
</ul>

<p><img src="http://image.gihyo.co.jp/assets/images/dev/feature/01/opencv/0003/thumb/TH400_01.png" alt=""></p>

<ul>
<li>検出器を使って目的のオブジェクトを検出</li>
</ul>
</div>
</div>
<div id="one_02_slide" class="slide small" data-transition="none">
<div class="content small" ref="one/02_slide/3">
<h1>サンプル作成と機械学習</h1>

<p><img src="http://image.gihyo.co.jp/assets/images/dev/feature/01/opencv/0004/thumb/TH250_03.png" alt="" height="500"></p>
</div>
</div>
<div id="one_02_slide" class="slide small" data-transition="none">
<div class="content small" ref="one/02_slide/4">
<h1>サンプル作成と機械学習</h1>

<h2>NG.txt</h2>

<div class="txt">
./NG/image_001.jpg<br>
./NG/image_002.jpg<br>
./NG/image_003.jpg<br>
.<br>
.<br>
.<br>
</div>

<h2>OK.txt</h2>

<div class="txt">
./OK/image_001.jpg 3 0 0 50 50 32 45 20 30 44 78 5 30<br>
./OK/image_002.jpg 2 30 47 39 49 40 55 19 28<br>
./OK/image_003.jpg 1 0 0 30 30<br>
.<br>
.<br>
.<br>
</div>
</div>
</div>
<div id="one_02_slide" class="slide small" data-transition="none">
<div class="content small" ref="one/02_slide/5">
<h1>サンプル作成と機械学習</h1>

<h2>OK.txt作らなきゃ</h2>

<ul>
<li>
<a href="https://github.com/takmin/ObjectMarker">ObjectMarker</a>なるものがあるらしい</li>
<li>ビルドできない(情弱)</li>
<li>作りゃいいじゃん(ｼﾞｬｯｳﾞｧで)<br>
→GAIAで培ったMVCをガン無視する技術でGUIを作成<br>
(現在MVCに則って改造中)</li>
</ul>
</div>
</div>
<div id="one_02_slide" class="slide commandline incremental small" data-transition="none">
<div class="content commandline incremental small" ref="one/02_slide/6">
<h2>作成したOK.txtでサンプル作成からの機械学習</h2>

<pre><code><code class="command">$ createsamples -info OK.txt -vec output.vec -num 4000 -bgcolor 255 -w 44 -h 18</code>
<code class="command">$ haartraining -data hoge -vec output.vec -bg NG.txt -npos 4000 -nneg 1685 -w 44 -h 18 -mode ALL</code>
</code></pre>

<div class="aa">
　　　　　　　　　　　　 ／）<br>
　　　　　　　　　　　／／／）<br>
　　　　　　　　　 ／,.=ﾞ''"／<br>
　　　／　　　　 i f　,.r='"-‐'つ＿＿＿_　　　　　コマンド打ちゃあいいんだよ！！<br>
　　/　　　　　 /　　　_,.-‐'~／⌒　　⌒＼<br>
　　　　／　 　,i　　　,二ﾆ⊃（ ＞）.　（＜）＼<br>
　　　/　 　　ﾉ　　　 ilﾞフ::::::⌒（__人__）⌒::::: ＼<br>
　　　　　　,ｲ｢ﾄ､　　,!,!|　　　　　|r┬-|　　　　　|<br>
　　　　　/　iﾄヾヽ_/ｨ"＼ 　　 　 `ー'´ 　 　 ／<br>
<br>
</div>

<div class="aa" align="center">
＿人人人人人人人人人人人人人人人人人＿  <br>
＞　めっちゃ時間かかるけどな！！！　＜  <br>
￣Y^Y^Y^Y^Y^Y^Y^Y^Y^Y^Y^Y^Y^Y^Y^Y￣  <br>

</div>
</div>
</div>
<div id="two_01_slide" class="slide commandline incremental" data-transition="none">
<div class="content commandline incremental" ref="two/01_slide/1">
<h2>オブジェクト検出器</h2>

<p>さっきめっちゃ時間かけて作ったXMLのことです(嫌な思い出)<br>
使います(Rubyで)  </p>

<p>まずは</p>

<pre><code><code class="command">$ bundle init                        </code>
<code class="command">$ echo 'gem "ruby-opencv"' &gt;&gt; Gemfile</code>
<code class="command">$ bundle install --path vendor/bundle</code>
</code></pre>
</div>
</div>
<div id="two_01_slide" class="slide subsection" data-transition="none">
<div class="content subsection" ref="two/01_slide/2">
<h1>何に使おうか？</h1>

<h2>~笑い男ごっこ編~</h2>
</div>
</div>
<div id="two_01_slide" class="slide " data-transition="none">
<div class="content " ref="two/01_slide/3">
<p>さっきめっちゃ時間かけて作った検出器ではないものを使って顔検出<br>
(だって顔検出器OpenCVに入ってんだもん)<br>
→笑い男になれる！</p>

<p><img src="http://bronzeback.cocolog-nifty.com/photos/uncategorized/2007/09/27/laughingman_2.gif" alt="" height="200"></p>
</div>
</div>
<div id="two_01_slide" class="slide execute smaller" data-transition="none">
<div class="content execute smaller" ref="two/01_slide/4">
<h1>これであなたも笑い男</h1>

<pre class="sh_ruby"><code>require 'opencv'
include OpenCV

def laughing_man(image, rect, laughing_man)
  image.set_roi rect
  laughing_man_resized = laughing_man.resize rect
  (image.rows * image.cols).times do |i|
    image[i] = laughing_man_resized[i] unless laughing_man_resized[i][0] == 0.0
  end
  image.reset_roi
end</code></pre>
</div>
</div>
<div id="two_01_slide" class="slide execute smaller" data-transition="none">
<div class="content execute smaller" ref="two/01_slide/5">
<h1>これであなたも笑い男続き</h1>

<pre class="sh_ruby"><code>camera = CvCapture.open(0)
face_detector = CvHaarClassifierCascade::load("#{HAAR_CASCADE_PATH}/haarcascade_frontalface_default.xml")

window = GUI::Window.new('camera')
laughing_man_img = CvMat.load("#{LAUGHINGMAN_PATH}/laughingman.png")

while GUI::wait_key(50).nil?
  image = camera.query
  image = image.resize(CvSize.new(500, 350))

  face_detector.detect_objects(image) do |face_rect|
    laughing_man(image, face_rect, laughing_man_img)
  end

  window.show image
end

window.destroy</code></pre>
</div>
</div>
<div id="two_01_slide" class="slide " data-transition="none">
<div class="content " ref="two/01_slide/6">
<h1>実演</h1>

<h2>Demonstration</h2>
</div>
</div>
<div id="two_02_slide" class="slide subsection" data-transition="none">
<div class="content subsection" ref="two/02_slide/1">
<h1>何に使おうか？</h1>

<h2>~ボルダリング編~</h2>
</div>
</div>
<div id="two_02_slide" class="slide smaller" data-transition="none">
<div class="content smaller" ref="two/02_slide/2">
<h2>ちゃんと作った検出器使わねば</h2>

<pre class="sh_ruby"><code>require 'opencv'
include OpenCV

hold_detector = CvHaarClassifierCascade::load("./mark_test/bouldering_hold.xml")

window = GUI::Window.new('boulder')
image = IplImage.load(ARGV[0])

hold_detector.detect_objects(image) do |hold|
  topleft = CvPoint.new(hold.x, hold.y)
  bottomright = CvPoint.new(hold.x + hold.width, hold.y + hold.height)
  image.rectangle!(topleft, bottomright, color: CvColor::Red, thickness: 1)
end

window.show image

GUI::wait_key</code></pre>
</div>
</div>
<div id="two_02_slide" class="slide " data-transition="none">
<div class="content " ref="two/02_slide/3">
<h2>結果</h2>

<p><img src="./file/two/./2015-03-30T2346060900.png" alt="result"></p>

<p>微妙(白目)</p>
</div>
</div>
<div id="two_02_slide" class="slide " data-transition="none">
<div class="content " ref="two/02_slide/4">
<h1>(白目)</h1>

<table>
<thead>
<tr>
<th style="text-align: left">ポジティブ画像</th>
<th style="text-align: left">ネガティブ画像</th>
<th style="text-align: left">学習時間</th>
<th style="text-align: left">精度(抽象的なもの)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">3,000枚</td>
<td style="text-align: left">20枚</td>
<td style="text-align: left">約40分</td>
<td style="text-align: left">ほとんど正しく検出されません</td>
</tr>
<tr>
<td style="text-align: left">4,000枚</td>
<td style="text-align: left">2,000枚</td>
<td style="text-align: left">約8時間</td>
<td style="text-align: left">誤検出が見られます</td>
</tr>
<tr>
<td style="text-align: left">8,000枚</td>
<td style="text-align: left">4,000枚</td>
<td style="text-align: left">約1週間</td>
<td style="text-align: left">誤検出がほとんどありません</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="two_02_slide" class="slide " data-transition="none">
<div class="content " ref="two/02_slide/5">
<p>地道に枚数増やしていきます<br>
そうします</p>
</div>
</div>
<div id="two_02_slide" class="slide " data-transition="none">
<div class="content " ref="two/02_slide/6">
<h1>実演はなしで</h1>

<h2>No Demonstration</h2>
</div>
</div>
<div id="two_03_slide" class="slide subsection" data-transition="none">
<div class="content subsection" ref="two/03_slide/1">
<h1>何に使おうか？</h1>

<h2>~緑のランバ・ラル編~</h2>
</div>
</div>
<div id="two_03_slide" class="slide small" data-transition="none">
<div class="content small" ref="two/03_slide/2">
<p>我が家にぐーふーがきたんですよ<br>
<img src="http://livedoor.blogimg.jp/vipdayo/imgs/0/5/052b4782.jpg" alt="グフ"></p>
</div>
</div>
<div id="two_03_slide" class="slide " data-transition="none">
<div class="content " ref="two/03_slide/3">
<p>名前は<strike>ランバラル</strike><br>
まるたろう<br>
<img src="http://game.watch.impress.co.jp/img/gmw/docs/564/436/gn_03_s.gif" alt="ランバラル"></p>

<p>でも僕はランバラルって(心の中で)呼び続けようと思うんだ</p>
</div>
</div>
<div id="two_03_slide" class="slide " data-transition="none">
<div class="content " ref="two/03_slide/4">
<h2>
<strike>ランバラル</strike>まるたろうを見ていて気付いたのは以外と個体によって顔も模様も違うってこと</h2>

<p>まるたろう(ランバラル)の写真撮りまくって、<br>
他の個体の写真をNGにしたら、<br>
(おそらく)世界初ミドリフグの個体識別ができるんじゃないか？
<img src="https://scontent.xx.fbcdn.net/hphotos-xaf1/v/t1.0-9/644424_741597202604462_2440489367593472995_n.jpg?oh=9c943ee2ca90b2356f02fc311d66fedc&amp;oe=5570DE44" alt="ぐーふー"></p>
</div>
</div>
<div id="two_03_slide" class="slide " data-transition="none">
<div class="content " ref="two/03_slide/5">
<div class="aa">
　　　　　　　/ﾆＹﾆヽ<br>
　 　(ヽ　 　/（ ﾟ )( ﾟ ）ヽ　　　/)<br>
　　(((i ) ／::::⌒｀´⌒::::＼ 　( i)))　　でっていうｗｗｗｗｗｗｗｗｗｗｗｗｗｗｗ<br>
　／∠_|　,-）＿＿＿（-，|＿ゝ ＼<br>
( ＿＿＿､　　|-┬-|　　　　,＿＿ ）<br>
　　　　|　　　　`ー'´　　 /´<br>
　　　　|　　　　　　　　　/ <br>
<br>
</div>
</div>
</div>
<div id="two_03_slide" class="slide " data-transition="none">
<div class="content " ref="two/03_slide/6">
<h1>実演は(やるなら)今後</h1>

<h2>COMING SOON?</h2>
</div>
</div>
<div id="two_03_slide" class="slide subsection" data-transition="none">
<div class="content subsection" ref="two/03_slide/7">
<h1>ご清聴ありがとうございます</h1>

<h2>質問はお手柔らかに</h2>
</div>
</div>
</div>
<div id="pauseScreen">
  PAUSED
</div>

</body>
</html>
